## 消息队列的典型使用场景

1. 系统间的通知. 比如, A系统负责处理R资源, B系统要在R资源改动是作一些处理, 这种场景下非常适合使用队列进行通知.
2. 消息分发的场景. 比如聊天. 
3. 跨系统回调的实现. 除了实现HTTP callback url, 还可以使用队列来实现回调.
4. RPC.

## 消息送达性保证

消息的生命周期分为两个阶段, Producer <-> Q <-> Consumer. 这两个阶段都会发生可达性的问题. 

1. 消息确认/ACK机制. 消息发送出去必须要等到对放确认. 在第一个阶段, 如果消息没有经过Q的确认, 则Producer会进行重发, 第二个阶段如果Consumer没有确认, Q则不会删掉这条消息, 而且还会进行重发. 所以要确保消息的幂等性. 因为整个过程中会发生消息重复发送. 

重发策略一般采用指数退避的策略，先隔x秒重发，2x秒重发，4x秒重发，以此类推

2. 了解一下best-effort-delivery, 进最大努力送达. 这种方式不能确保消息的可达性.


## 消息的幂等性/exectly once

可以为每条消息生成全局唯一的ID, 如果Queue能够提供唯一性校验, 则可以确保发送方消息的幂等性. 消费方的要进行幂等性的设计, 比如这个ID已经处理过则, 不能重复处理.

