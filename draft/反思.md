# Bla

21号上线完新功能，本想像往常一样美美的歇会儿，喝口茶。但还没起身就收到了系统报警，五六个系统都出了问题。同时接五六个系统的报警还是很刺激的事儿。赶紧看日志，确实和新上的功能相关。火急火燎的折腾了两个小时终于搞定，世界太平。

1.为啥测试环境测过的功能上生产有问题？

扪心自问，测试环境我们的打开方式对吗？测试环境和生产环境的代码是一致的吗？是不是做到了新功能先合并测试，然后再上生产？上测试的代码，是正确的吗？做过测试吗？

在我们这里测试环境仅仅充当的是集成环境。代码写完合并到测试环境直接就发版了。首先代码没有测试，实现的逻辑是否正确不能保证。有的时候解决线上问题合并了master之后，test早就忘了。所以，测试环境基本是不靠谱的。充当的是集成和联调的功能。

2.为啥没快速回滚？

当意识到新功能有问题的时候，我立马进行了回滚。但是报错只是相应的减少了并没有彻底消失。这边django和celery独立部署，登录服务器发现django的代码回滚了，但是celery的没有回滚。直接崩溃了。事后team lead找出了事情的原因：回滚的话要分别回滚django，celery，还有一个加了new relic的django server。

你对公司项目的部署熟悉吗？能够独立部署和回滚吗？如果没有赶紧学去吧！

3.为啥一个系统出问题好多系统都被带到了沟里？

4.为啥一个小毛病不能快速修复？
